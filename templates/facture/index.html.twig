{% extends 'empty.html.twig' %}

{% block body %}
<style>
    body {
        font-family: DejaVu Sans, Arial, sans-serif;
        font-size: 12px;
        color: #333;
        margin: 20px;
    }

    h1 {
        font-size: 22px;
        margin-bottom: 10px;
    }

    .invoice-header {
        margin-bottom: 20px;
    }

    .seller-client {
        width: 100%;
        border: 1px solid #000;
        border-collapse: collapse;
        padding: 10px;
        margin-bottom: 25px;
    }

    .seller-client td {
        width: 50%;
        vertical-align: top;
        padding: 5px;
    }

    .product-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
        font-size: 12px;
    }

    .product-table th {
        background-color: #f2f2f2;
        border: 1px solid #000;
        text-align: center;
        padding: 6px;
        font-weight: bold;
    }

    .product-table td {
        border: 1px solid #000;
        padding: 6px;
    }

    .product-table tr:nth-child(even) {
        background-color: #fafafa;
    }

    .text-right {
        text-align: right;
    }

    .totals {
        margin-top: 25px;
        width: 100%;
        border-collapse: collapse;
        font-size: 12px;
    }

    .totals td, .totals th {
        border: 1px solid #000;
        padding: 6px;
    }

    .totals th {
        background-color: #f2f2f2;
        text-align: right;
    }

    .legal {
        font-size: 11px;
        margin-top: 20px;
        line-height: 1.4;
    }
</style>

<div class="invoice-header">
    <h1>Facture n° {{ sale.id }}</h1>
    <p><strong>Date d’émission :</strong> {{ sale.createdAt|date('d/m/Y') }}</p>
</div>

<table class="seller-client">
    <tr>
        <td>
            <strong>{{ sellerName }}</strong><br>
            {{ sellerAddress }}<br>
            {% if sellerSiret %}SIRET : {{ sellerSiret }}<br>{% endif %}
            {% if sellerVatNumber %}TVA intracom : {{ sellerVatNumber }}<br>{% endif %}
            {% if sellerLegalForm %}Forme juridique : {{ sellerLegalForm }}<br>{% endif %}
            {% if sellerActivity %}Activité : {{ sellerActivity }} ({{ sellerNafApe }}){% endif %}
        </td>
        <td style="text-align:right;">
            <strong>{{ sale.clientName }}</strong><br>
            {{ sale.clientAddress }}
        </td>
    </tr>
</table>

<table class="product-table">
    <tr>
        <th style="width: 40%;">Désignation</th>
        <th style="width: 15%;">Quantité</th>
        <th style="width: 15%;">PU HT</th>
        <th style="width: 10%;">TVA</th>
        <th style="width: 20%;">Total HT</th>
    </tr>
    {% if sale.saleProducts is not empty %}
        {% for saleProduct in sale.saleProducts %}
            <tr>
                <td>{{ saleProduct.product.name }}</td>
                <td class="text-right">{{ saleProduct.quantity|number_format(2, ',', ' ') }}</td>
                <td class="text-right">{{ saleProduct.price|number_format(2, ',', ' ') }} €</td>
                <td class="text-right"></td>
                <td class="text-right">{{ (saleProduct.quantity * saleProduct.price)|number_format(2, ',', ' ') }} €</td>
            </tr>
        {% endfor %}
    {% else %}
        <tr>
            <td colspan="5" style="text-align:center; font-style:italic;">Aucun produit enregistré</td>
        </tr>
    {% endif %}
</table>

<table class="totals">
    <tr>
        <td style="width:70%; text-align:right;"><strong>Total HT</strong></td>
        <td class="text-right" style="width:30%;"></td>
    </tr>
    <tr>
        <td style="text-align:right;"><strong>TVA</strong></td>
        <td class="text-right"></td>
    </tr>
    <tr>
        <th style="text-align:right;">Total TTC</th>
        <th class="text-right"></th>
    </tr>
</table>

<p style="margin-top:10px;">
    <strong>Date d’échéance :</strong> 
</p>

<div class="legal">
    {% if sellerTvaExemption == 'true' %}
        <p>TVA non applicable, article 293 B du CGI.</p>
    {% else %}
        <p>TVA due au taux indiqué ci-dessus.</p>
    {% endif %}
    <p>Pénalités de retard : {{ sellerLatePaymentRate|default('10') }} %/an et indemnité forfaitaire de 40 € (art. L441-10 C. com.).</p>
</div>
{% endblock %}