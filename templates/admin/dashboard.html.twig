{% extends '@EasyAdmin/page/content.html.twig' %}

{% block content %}
<div class="w-100">
    <h1 class="text-2xl font-bold mb-4">Bienvenue dans le back-office Boulangerie ðŸ¥–</h1>

    <!-- Cards -->
    <div class="row mb-4">
        <div class="col-md-3 border p-3 text-white bg-dark me-2">
            <h4>Total ventes</h4>
            <p class="fs-3">{{ totalSales }}</p>
        </div>
        <div class="col-md-3 border p-3 text-white bg-dark">
            <h4>Montant total</h4>
            <p class="fs-3">{{ totalAmount|number_format(2, '.', ',') }} â‚¬</p>
        </div>
    </div>

    <!-- SÃ©lection du mois -->
    <form method="get" class="mb-3">
        <label for="month">Mois :</label>
        <select name="month" id="month" onchange="this.form.submit()">
            {% for num, name in months %}
                <option value="{{ num }}" {% if currentMonth == num %}selected{% endif %}>{{ name }}</option>
            {% endfor %}
        </select>
    </form>

    <!-- Chart recettes par jour -->
<div class="d-flex justify-content-start mb-4">
    <div class="w-50">
        <canvas id="revenueChart" class="bg-dark p-3 rounded w-100"></canvas>
    </div>
</div>
</div>

<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const data = {
        labels: {{ dailyRevenueLabels|json_encode|raw }},
        datasets: [{
            label: 'Recette par jour',
            data: {{ dailyRevenueValues|json_encode|raw }},
            backgroundColor: 'rgba(75, 192, 192, 0.5)',
        }]
    };
</script>
<script>
const ctx = document.getElementById('revenueChart').getContext('2d');

const revenueChart = new Chart(ctx, {
    type: 'bar',
    data: {
        labels: {{ dailyRevenueLabels|json_encode|raw }},
        datasets: [{
            label: 'Recette (â‚¬)',
            data: {{ dailyRevenueValues|json_encode|raw }},
            backgroundColor: 'rgba(255, 255, 255, 0.7)',
            borderColor: 'rgba(255, 255, 255, 1)',
            borderWidth: 1
        }]
    },
    options: {
        responsive: true,
        scales: {
            x: { 
                ticks: { color: 'white' },
                grid: { color: 'rgba(255,255,255,0.1)' }
            },
            y: {
                beginAtZero: true,
                ticks: { color: 'white' },
                grid: { color: 'rgba(255,255,255,0.1)' }
            }
        },
        plugins: {
            legend: { labels: { color: 'white' } }
        }
    }
});
</script>
{% endblock %}
