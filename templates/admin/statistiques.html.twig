{% extends '@EasyAdmin/page/content.html.twig' %}

{% block content %}


<!-- JS -->
<script src="/assets/js/jquery-3.7.1.min.js"></script>
<script src="/assets/js/chart-js-4.5.0.js"></script>

<div class="w-100 py-4">
    <h1 class="text-2xl font-bold mb-4">{{ 'Back-office Boulangerie ðŸ¥–'|trans }}</h1>

    <!-- Cards statistiques -->
    <div class="row mb-4 g-3">
        <div class="col-md-3">
            <div class="card ea-bg-card rounded-3 shadow-sm text-center p-3 h-100">
                <h5 class="card-title">{{ 'Total ventes'|trans }}</h5>
                <p class="fs-3">{{ totalSales }}</p>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card ea-bg-card rounded-3 shadow-sm text-center p-3 h-100">
                <h5 class="card-title">{{ 'Montant total'|trans }}</h5>
                <p class="fs-3">{{ totalAmount|number_format(2, ',', ' ') }} â‚¬</p>
            </div>
        </div>
    </div>

    <!-- SÃ©lection du mois -->
    <div class="mb-4">
    <label for="month" class="form-label fw-semibold me-2">{{ 'Mois'|trans }} :</label>
    <select id="month" class="form-select w-auto d-inline-block"
            onchange="window.location.href = this.options[this.selectedIndex].dataset.url;">
        {% for num, name in months %}
            {% set url = path('admin_statistiques', {'id': num, 'month': num}) %}
            <option value="{{ num }}"
                    data-url="{{ url }}"
                    {% if currentMonth == num %}selected{% endif %}>
                {{ name|trans }}
            </option>
        {% endfor %}
    </select>
</div>

    <div class="container">
    <div class="row justify-content-start mb-3">
        <div class="col-6">
            <!-- Chart title with month -->
            <h3 class="text-white">
                {{ 'Recettes du mois de'|trans }} {{ months[currentMonth]|trans }}
            </h3>
        </div>
    </div>

    <div class="row justify-content-start">
        <div class="col-6" style="height: 500px;">
            <canvas id="revenueChart"></canvas>
        </div>
    </div>
</div>

<script>
const ctx = document.getElementById('revenueChart').getContext('2d');

new Chart(ctx, {
    type: 'bar',
    data: {
        labels: {{ dailyRevenueLabels|json_encode|raw }},
        datasets: [{
            label: '{{ "Recette (â‚¬)"|trans }}',
            data: {{ dailyRevenueValues|json_encode|raw }},
            backgroundColor: 'rgba(0, 51, 102, 0.8)', // dark blue
            borderColor: 'rgba(0, 51, 102, 1)',
            borderWidth: 1,
            hoverBackgroundColor: 'rgba(0, 51, 102, 1)' // effect on hover
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
            x: { 
                ticks: { color: 'white' },
                grid: { color: 'rgba(255,255,255,0.1)' }
            },
            y: {
                beginAtZero: true,
                ticks: { color: 'white' },
                grid: { color: 'rgba(255,255,255,0.1)' }
            }
        },
        plugins: {
            legend: { labels: { color: 'white' } }
        }
    }
});
</script>
{% endblock %}