{% extends '@EasyAdmin/page/content.html.twig' %}

{% block content %}
<div class="container w-100 py-4">
    <h1 class="text-2xl font-bold mb-4">{{ 'Back-office Boulangerie ðŸ¥–'|trans }}</h1>

    <!-- Cards statistiques -->
    <div class="row mb-4 g-3">
        <div class="col-md-3">
            <div class="card ea-bg-card rounded-3 shadow-sm text-center p-3 h-100">
                <h5 class="card-title">{{ 'Total ventes'|trans }}</h5>
                <p class="fs-3">{{ totalSales }}</p>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card ea-bg-card rounded-3 shadow-sm text-center p-3 h-100">
                <h5 class="card-title">{{ 'Montant total'|trans }}</h5>
                <p class="fs-3">{{ totalAmount|number_format(2, ',', ' ') }} â‚¬</p>
            </div>
        </div>
    </div>

    <!-- SÃ©lection du mois -->
    <form method="get" class="mb-4 d-flex align-items-center gap-2">
        <label for="month" class="mb-0">{{ 'Mois'|trans }} :</label>
        <select name="month" id="month" onchange="this.form.submit()" class="form-select w-auto">
            {% for num, name in months %}
                <option value="{{ num }}" {% if currentMonth == num %}selected{% endif %}>{{ name|trans }}</option>
            {% endfor %}
        </select>
    </form>

    <!-- Chart recettes par jour -->
    {# <div class="mb-4">
        <div class="ea-bg-card p-3 rounded shadow-sm" style="width:100%; max-width:800px; margin:auto;">
            <canvas id="revenueChart" style="width:100%; height:400px;"></canvas>
        </div>
    </div> #}

        <div style="width: 800px;"><canvas id="revenueChart"></canvas></div>
</div>

<!-- JS -->
<script src="/assets/js/jquery-3.7.1.min.js"></script>
<script src="/assets/js/chart-js-4.5.0.js"></script>

<script>
const ctx = document.getElementById('revenueChart').getContext('2d');

new Chart(ctx, {
    type: 'bar',
    data: {
        labels: {{ dailyRevenueLabels|json_encode|raw }},
        datasets: [{
            label: '{{ "Recette (â‚¬)"|trans }}',
            data: {{ dailyRevenueValues|json_encode|raw }},
            backgroundColor: 'rgba(75, 192, 192, 0.7)',
            borderColor: 'rgba(255, 255, 255, 1)',
            borderWidth: 1
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: false, // important pour respecter la hauteur
        scales: {
            x: { 
                ticks: { color: 'white' },
                grid: { color: 'rgba(255,255,255,0.1)' }
            },
            y: {
                beginAtZero: true,
                ticks: { color: 'white' },
                grid: { color: 'rgba(255,255,255,0.1)' }
            }
        },
        plugins: {
            legend: { labels: { color: 'white' } }
        }
    }
});

</script>


{% endblock %}